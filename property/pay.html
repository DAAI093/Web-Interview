<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Access-Control-Allow-Origin" content="*" />
    <title>充值缴费</title>
    <link rel="stylesheet" href="./css/common.css">
    <link rel="stylesheet" href="./css/pay.css">
    <script src="https://cdn.bootcss.com/jquery/2.1.1/jquery.min.js"></script>
    <script src="./js/zepto.min.js"></script>
</head>

<body>
    <!-- 顶部信息 -->
    <header class="header">
        <a class="header_img" href="javascript:history.back();">
            <img src="./img/back_icon copy@2x.png" alt="">
        </a>
        <span class="header_comment">充值缴费</span>
    </header>
    <!-- img部分 -->
    <div class="content">
        <img src="./img/充值 copy@2x.png" alt="" class="chongzhi">
    </div>
    <!-- 这里是里面所有的部分 -->
    <div class="All_Con">
        <!-- 玩法介绍 -->
        <span class="play_inc">
            充值玩法
        </span>
        <!-- 内容 -->
        <div class="text_info">
            业主通过平台一次性缴纳两年物业管理费， 平台将赠送业主一年物业管理费， 业主三年 内无需再缴纳物业管理费，平台会分36月 每月定期打款给业主个人账号。 三年到期时， 平台将再赠送15%的延丰积分给业主。
        </div>
        <!-- 金额 -->
        <div class="pay_nu">
            <span class="play_inc">
                充值金额
            </span>
            <input type="text" placeholder="￥" name="" id="" class="jine">
        </div>
        <!-- 账户 -->
        <div class="zhanghu">
            <span class="zhanghu_inc">
                账户信息
            </span>
            <input type="text" placeholder="银行开户名" name="" id="" class="bname">
            <input type="text" placeholder="银行账户" name="" id="" class="card_num">
            <input type="text" placeholder="银行开户行" name="" id="" class="bank_name">
            <input type="text" placeholder="手机号" name="" id="" class="mobile">
        </div>
        <!-- 确认按钮 -->
        <!-- 底部按钮 -->
        <footer class="btn">
            <!-- 充值 -->
            <!-- 这里的图有问题，位置，看看哪里 -->
            <button type="button" class="btn1 btn-default">
                确认支付
            </button>
        </footer>
    </div>
    <!-- 模态框 请完善您的信息 display:none;-->
    <div class="ljtb" style="display:none;background:#fcfcfc;border-width: 1px; width: 20.5rem; height: 4rem;line-height:3rem;padding-top:0.5rem;;text-align: center; font-size: 0.34rem; border-radius: 5px;position:absolute;left:17%;top:130%;">
        <span style="color:#f44d4e;line-height:0.96rem;font-size: 1.1rem;font-family: PingFangSC-Medium;font-weight: 400">
            填写信息有误，请正确填写您的信息！
        </span>
    </div>
</body>
<script src="./js/pay.js"></script>
<!-- <script>
    var rep = {
        "head": {
            "token": "OGI2Njg1NDVmZjI5NGE4MGEwN2EyNDIzNTA1MjIzMTg=",
            "appAccount": "abd73a2657bd41cebde60c1b4bc3ada8",
            "version": "1.0",
            "deviceType": 1
        },
        "content": {
            "type": 1,
            "trade_num": "100",
            "account_info": {
                "name": "开户名",
                "card_num": "4406111",
                "bank_name": "农业银行",
                "mobile": "18306618242",
            },
        }
    };

    //2. 定义一个标志位用来给之后的模态框作为判断依据
    var flag = false; //未必用到

    // 3.预先备份上面的内容
    var jsonrep = rep;

    // 3.开始获取输入框的数值 构建关系
    rep.content.trade_num = $(".jine").val(); //金额
    rep.content.account_info.name = $(".bname").val(); //
    rep.content.account_info.card_num = $(".card_num").val(); //
    rep.content.account_info.bank_name = $(".bank_name").val(); //
    rep.content.account_info.mobile = $(".mobile").val(); //

    // 验证金额是否输入为数字
    function checkNumber(theObj) {
        var reg = /^[0-9]+.?[0-9]*$/;
        if (reg.test(theObj)) {
            return true;
        }
        return false;
    }

    // 验证手机
    function isPoneAvailable(str) {
        var myreg = /^[1][3,4,5,7,8][0-9]{9}$/;
        if (!myreg.test(str)) {
            return false;
        } else {
            return true;
        }
    }

    // 模态框
    function motaikuang() {
        setTimeout(() => {
            $(".ljtb").fadeOut()
            $(".jine").val("");
            $(".mobile").val("");
        }, 1500);
        $(".ljtb").css({
            "display": "block"
        })
        $(".ljtb").fadeIn();
    }
    // function motaikuang() {
    //     setTimeout(() => {
    //         $(".ljtb").fadeOut()
    //         $(".jine").val("");
    //         $(".mobile").val("");
    //     }, 1500);
    //     $(".ljtb").css({
    //         "display": "block"
    //     })
    //     $(".ljtb").fadeIn();
    // }

    function submit() {
        var timer = setInterval(function () {
            // 启动定时器监听赋值
            rep.content.trade_num = $(".jine").val(); //金额
            rep.content.account_info.name = $(".bname").val(); //
            rep.content.account_info.card_num = $(".card_num").val(); //
            rep.content.account_info.bank_name = $(".bank_name").val(); //
            rep.content.account_info.mobile = $(".mobile").val(); //
            // 对输入信息进行判断
            // 金额
            if (!checkNumber(rep.content.trade_num)) {
                motaikuang();
                // rep.content.trade_num = "";
                clearInterval(timer)
                return false;
            }
            // 手机号码
            if (!isPoneAvailable(rep.content.account_info.mobile)) {
                motaikuang();
                clearInterval(timer)
                return false;
            }
        }, 500)
    }

    $(".btn1").click(function () {
        // 1.对输入信息进行判断
        submit();
        console.log(rep);
        var reps = JSON.stringify(rep)
        // 传参为string类型
        $.get(`http://app-dev.ydycaigou.com:8081/app/rebate/create_order`,reps,(res)=>{
                console.log(res);
                console.log("-----")
                console.log(res.data.order_id);
                localStorage.setItem("order_id",res.data.order_id)
                location.href = "./index.html";
        },"jsonp")
        // clearInterval(timer);
    })
</script> -->

</html>